import{d as l,w as g}from"./C3K3qoHi.js";const p={session:null,isLoading:!1,isAuthenticated:!1,permissions:{users:{create:!1,read:!1,update:!1,delete:!1},players:{create:!1,read:!1,update:!1,delete:!1},contests:{create:!1,read:!1,update:!1,delete:!1},matches:{create:!1,read:!1,update:!1,delete:!1}}},c={superadmin:[{resource:"*",actions:["create","read","update","delete","publish","lock"]}],admin:[{resource:"contests",actions:["create","read","update","delete","publish","lock"]},{resource:"matches",actions:["create","read","update","delete"]},{resource:"players",actions:["create","read","update","delete"]},{resource:"users",actions:["read","update"]},{resource:"wallet",actions:["read","create"]},{resource:"reports",actions:["read"]},{resource:"settings",actions:["read","update"]}],moderator:[{resource:"contests",actions:["read","update","publish"]},{resource:"matches",actions:["read","update"]},{resource:"players",actions:["read","update"]},{resource:"users",actions:["read"]},{resource:"wallet",actions:["read"]},{resource:"reports",actions:["read"]}],viewer:[{resource:"contests",actions:["read"]},{resource:"matches",actions:["read"]},{resource:"players",actions:["read"]},{resource:"users",actions:["read"]},{resource:"wallet",actions:["read"]},{resource:"reports",actions:["read"]},{resource:"settings",actions:["read"]}]};function y(){const{subscribe:t,set:w,update:n}=g(p);return{subscribe:t,async login(a,o){n(e=>({...e,isLoading:!0}));try{await new Promise(s=>setTimeout(s,1e3));const r={"admin@dream11.com":{user:{id:"admin-1",email:"admin@dream11.com",name:"Super Admin",balance:0,kycVerified:!0,role:"superadmin",createdAt:new Date},role:"superadmin",password:"admin123"},"manager@dream11.com":{user:{id:"admin-2",email:"manager@dream11.com",name:"Admin Manager",balance:0,kycVerified:!0,role:"admin",createdAt:new Date},role:"admin",password:"manager123"},"mod@dream11.com":{user:{id:"admin-3",email:"mod@dream11.com",name:"Moderator",balance:0,kycVerified:!0,role:"moderator",createdAt:new Date},role:"moderator",password:"mod123"},"viewer@dream11.com":{user:{id:"admin-4",email:"viewer@dream11.com",name:"Viewer",balance:0,kycVerified:!0,role:"viewer",createdAt:new Date},role:"viewer",password:"viewer123"}}[a];if(r&&o===r.password){const s={user:r.user,role:r.role,permissions:c[r.role]||[]},i={users:{create:!1,read:!1,update:!1,delete:!1},players:{create:!1,read:!1,update:!1,delete:!1},contests:{create:!1,read:!1,update:!1,delete:!1},matches:{create:!1,read:!1,update:!1,delete:!1}};return(c[r.role]||[]).forEach(d=>{(d.resource==="*"||i[d.resource])&&d.actions.forEach(m=>{d.resource==="*"?Object.keys(i).forEach(h=>{i[h][m]=!0}):i[d.resource][m]=!0})}),n(d=>({...d,session:s,isAuthenticated:!0,isLoading:!1,permissions:i})),typeof window<"u"&&localStorage.setItem("admin_session",JSON.stringify(s)),{success:!0}}else return n(s=>({...s,isLoading:!1})),{success:!1,error:"Invalid credentials"}}catch{return n(r=>({...r,isLoading:!1})),{success:!1,error:"Network error"}}},logout(){w(p),typeof window<"u"&&localStorage.removeItem("admin_session")},init(){if(typeof window<"u"){const a=localStorage.getItem("admin_session");if(a)try{const o=JSON.parse(a),e={users:{create:!1,read:!1,update:!1,delete:!1},players:{create:!1,read:!1,update:!1,delete:!1},contests:{create:!1,read:!1,update:!1,delete:!1},matches:{create:!1,read:!1,update:!1,delete:!1}};(c[o.role]||[]).forEach(s=>{(s.resource==="*"||e[s.resource])&&s.actions.forEach(i=>{s.resource==="*"?Object.keys(e).forEach(f=>{e[f][i]=!0}):e[s.resource][i]=!0})}),n(s=>({...s,session:o,isAuthenticated:!0,permissions:e}))}catch{localStorage.removeItem("admin_session")}}},impersonateUser(a,o){n(e=>e.session?{...e,session:{...e.session,isImpersonating:!0,originalAdminId:e.session.user.id}}:e)},stopImpersonation(){n(a=>a.session?{...a,session:{...a.session,isImpersonating:!1,originalAdminId:void 0}}:a)},hasPermission(a,o){let e=!1;return t(r=>{if(!r.session){e=!1;return}if(r.session.role==="superadmin"){e=!0;return}e=r.session.permissions.some(s=>(s.resource===a||s.resource==="*")&&s.actions.includes(o))})(),e}}}const u=y();l(u,t=>t.isAuthenticated);l(u,t=>t.session);l(u,t=>t.session?.isImpersonating||!1);export{u as a};
