import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{o as Qe}from"../chunks/d-9Q_JcI.js";import{p as Ft,l as H,i as Dt,f as g,h as jt,t as re,c as s,s as n,g as e,o as l,a as h,b as Lt,$ as Bt,j as u,m as y,r,q as Tt,e as P,k as v,v as Ge,d as se,n as Je,w as ce}from"../chunks/CC47Dqnt.js";import{i as k}from"../chunks/3oX9xRnt.js";import{e as Ht,i as Ut}from"../chunks/Bar9hDmN.js";import{b as It,a as Rt,r as je,s as Ke,c as Vt}from"../chunks/BmFDec73.js";import{s as Ot}from"../chunks/CC5kzxMM.js";import{i as Nt}from"../chunks/6Z2O6PQy.js";import{a as qt,s as Qt}from"../chunks/DLEGmHds.js";import{a as Gt}from"../chunks/uE9PL26s.js";import{f as Jt}from"../chunks/Cj4IhdOJ.js";import{g as ue}from"../chunks/CHmzRBH6.js";import{A as J}from"../chunks/BKS5pudM.js";var Kt=g('<button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span>Create Contest</span></button>'),Wt=g('<button class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">Publish</button> <button class="px-3 py-1 bg-orange-600 text-white rounded text-sm hover:bg-orange-700">Lock</button>',1),Xt=g('<button class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">Delete</button>'),Yt=g('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex items-center justify-between"><span class="text-blue-800 font-medium"> </span> <div class="flex space-x-2"><!> <!> <button class="px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700">Clear</button></div></div></div>'),Zt=g('<button class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Create First Contest</button>'),er=g('<div class="p-8 text-center"><p class="text-gray-500">No contests found</p> <!></div>'),tr=g('<button class="text-green-600 hover:text-green-900" title="Publish"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button>'),rr=g('<button class="text-orange-600 hover:text-orange-900" title="Lock"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></button>'),sr=g('<button class="text-blue-600 hover:text-blue-900" title="Edit"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <!> <button class="text-purple-600 hover:text-purple-900" title="Clone"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>',1),ar=g('<button class="text-red-600 hover:text-red-900" title="Delete" aria-label="Delete contest"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),or=g('<tr class="hover:bg-gray-50"><td class="px-6 py-4"><input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"/></td><td class="px-6 py-4"><div><div class="text-sm font-medium text-gray-900"> </div> <div class="text-sm text-gray-500"> </div> <div class="text-sm text-gray-500"> </div></div></td><td class="px-6 py-4 text-sm text-gray-900"> </td><td class="px-6 py-4 text-sm text-gray-900"> <div class="w-full bg-gray-200 rounded-full h-2 mt-1"><div class="bg-blue-600 h-2 rounded-full"></div></div></td><td class="px-6 py-4"><span> </span></td><td class="px-6 py-4 text-sm font-medium"><div class="flex space-x-2"><!> <!></div></td></tr>'),ir=g('<div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6"><div class="flex items-center justify-between"><div class="flex-1 flex justify-between sm:hidden"><button class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50">Previous</button> <button class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50">Next</button></div> <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700">Showing <span class="font-medium"> </span> to <span class="font-medium"> </span> of <span class="font-medium"> </span> results</p></div> <div><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"><button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50">Previous</button> <button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50">Next</button></nav></div></div></div></div>'),nr=g('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left"><input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"/></th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contest</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prize Pool</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Entries</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div> <!>',1),lr=g('<div class="space-y-6"><div class="flex justify-between items-center"><div><h1 class="text-2xl font-bold text-gray-900">Contests Management</h1> <p class="text-gray-600">Manage contests, publish, lock, and track performance</p></div> <!></div> <div class="bg-white p-6 rounded-lg shadow"><div class="flex flex-col sm:flex-row gap-4"><div class="flex-1"><input type="text" placeholder="Search contests..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Status</option><option>Draft</option><option>Open</option><option>Closed</option><option>Finished</option></select></div> <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span>Export CSV</span></button></div></div> <!> <div class="bg-white rounded-lg shadow overflow-hidden"><!></div></div>');function kr(We,Xe){Ft(Xe,!1);const p=()=>Qt(Gt,"$adminAuthStore",Ye),[Ye,Ze]=qt(),et=y(),ve=y(),pe=y(),me=y(),Le=y(),he=y();let _=y([]),fe=[],K=y(""),U=y("all"),a=y(new Set),C=y(1),ae=y(1),be=10,I=y(0);const tt=[{name:"Free",entryFee:0,prizePool:100,maxEntries:1e3,multiEntry:!1,visibility:"public",scoringPreset:"standard"},{name:"Starter",entryFee:1,prizePool:50,maxEntries:100,multiEntry:!0,visibility:"public",scoringPreset:"standard"},{name:"Classic",entryFee:5,prizePool:250,maxEntries:100,multiEntry:!0,visibility:"public",scoringPreset:"premium"},{name:"High Roller",entryFee:25,prizePool:1e3,maxEntries:50,multiEntry:!0,visibility:"private",scoringPreset:"premium"}];Qe(async()=>{await Be()});async function Be(){try{fe=(await Jt.listUpcoming(new Date,new Date(Date.now()+6048e5))).filter(o=>o.curationState==="curated"),u(_,rt())}catch(t){console.error("Failed to load data:",t)}finally{}}function rt(){const t=[],o=["draft","published","locked","finished"],w=["Free","Starter","Classic","High Roller"];for(let m=0;m<25;m++){const d=w[Math.floor(Math.random()*w.length)],c=tt.find(z=>z.name===d),b=o[Math.floor(Math.random()*o.length)],x=new Date(Date.now()-Math.random()*7*24*60*60*1e3);t.push({id:`contest_${m+1}`,matchId:fe[Math.floor(Math.random()*Math.max(1,fe.length))]?.matchId||"match_1",title:`${d} Contest ${m+1}`,entryFee:c.entryFee,prizePool:c.prizePool,maxEntries:c.maxEntries,currentEntries:Math.floor(Math.random()*c.maxEntries*.8),multiEntry:c.multiEntry,visibility:c.visibility,region:"EU",scoringPreset:c.scoringPreset,template:d,status:b,publishedAt:b!=="draft"?new Date(x.getTime()+6e4):void 0,lockedAt:["locked","finished"].includes(b)?new Date(x.getTime()+12e4):void 0,finishedAt:b==="finished"?new Date(x.getTime()+18e4):void 0,createdAt:x,createdBy:p().session?.user.name||"Admin",auditTrail:[{who:p().session?.user.name||"Admin",what:"Contest created",when:x}]})}return t.sort((m,d)=>d.createdAt.getTime()-m.createdAt.getTime())}async function E(){await Be()}function st(t){e(a).has(t)?e(a).delete(t):e(a).add(t),u(a,e(a))}function at(){e(a).size===e(_).length?e(a).clear():e(_).forEach(t=>e(a).add(t.id)),u(a,e(a))}async function ot(t){try{const o=await J.publishContest(t);o.success?(f("Contest published successfully","success"),E()):f(o.error||"Failed to publish contest","error")}catch{f("Failed to publish contest","error")}}async function it(t){try{const o=await J.lockContest(t);o.success?(f("Contest locked successfully","success"),E()):f(o.error||"Failed to lock contest","error")}catch{f("Failed to lock contest","error")}}async function nt(t){if(confirm("Are you sure you want to delete this contest?"))try{const o=await J.deleteContest(t);o.success?(f("Contest deleted successfully","success"),E()):f(o.error||"Failed to delete contest","error")}catch{f("Failed to delete contest","error")}}async function lt(){if(confirm(`Publish ${e(a).size} selected contests?`))try{const t=Array.from(e(a)).map(o=>J.publishContest(o));await Promise.all(t),f(`${e(a).size} contests published successfully`,"success"),e(a).clear(),u(a,e(a)),E()}catch{f("Failed to publish contests","error")}}async function dt(){if(confirm(`Lock ${e(a).size} selected contests?`))try{const t=Array.from(e(a)).map(o=>J.lockContest(o));await Promise.all(t),f(`${e(a).size} contests locked successfully`,"success"),e(a).clear(),u(a,e(a)),E()}catch{f("Failed to lock contests","error")}}async function ct(){if(confirm(`Delete ${e(a).size} selected contests? This action cannot be undone.`))try{const t=Array.from(e(a)).map(o=>J.deleteContest(o));await Promise.all(t),f(`${e(a).size} contests deleted successfully`,"success"),e(a).clear(),u(a,e(a)),E()}catch{f("Failed to delete contests","error")}}function ut(t){ue(`/admin/contests/new?clone=${t.id}`)}function vt(){const t=[["ID","Title","Match ID","Prize Pool","Entry Fee","Max Entries","Current Entries","Status","Created At"].join(","),...e(_).map(d=>[d.id,`"${d.title}"`,d.matchId,d.prizePool,d.entryFee,d.maxEntries,d.currentEntries,d.status,d.createdAt.toISOString()].join(","))].join(`
`),o=new Blob([t],{type:"text/csv"}),w=URL.createObjectURL(o),m=document.createElement("a");m.href=w,m.download=`contests-${new Date().toISOString().split("T")[0]}.csv`,m.click(),URL.revokeObjectURL(w)}function f(t,o){console.log(`${o.toUpperCase()}: ${t}`)}function Te(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR"}).format(t)}function pt(t){switch(t){case"open":return"bg-green-100 text-green-800";case"closed":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";case"finished":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}function mt(){}function ht(){}Qe(()=>{E()}),H(()=>p(),()=>{u(et,p().session?.user.role==="superadmin"||p().session?.user.role==="admin")}),H(()=>p(),()=>{u(ve,p().session?.user.role==="superadmin"||p().session?.user.role==="admin"||p().session?.user.role==="moderator")}),H(()=>p(),()=>{u(pe,p().session?.user.role==="superadmin"||p().session?.user.role==="admin"||p().session?.user.role==="moderator")}),H(()=>p(),()=>{u(me,p().session?.user.role==="superadmin"||p().session?.user.role==="admin")}),H(()=>e(a),()=>{u(Le,e(a).size>0)}),H(()=>(e(_),e(K),e(U)),()=>{u(he,e(_).filter(t=>{const o=t.title.toLowerCase().includes(e(K).toLowerCase())||t.id.toLowerCase().includes(e(K).toLowerCase()),w=e(U)==="all"||t.status===e(U);return o&&w}))}),H(()=>(e(I),e(he)),()=>{u(I,e(he).length),u(ae,Math.ceil(e(I)/be))}),Dt(),Nt();var ge=lr();jt(t=>{Bt.title="Contests Management - Dream11 Admin"});var xe=s(ge),ft=n(s(xe),2);{var bt=t=>{var o=Kt();l("click",o,()=>ue("/admin/contests/new")),h(t,o)};k(ft,t=>{e(ve)&&t(bt)})}r(xe);var ye=n(xe,2),He=s(ye),_e=s(He),we=s(_e);je(we),r(_e);var ke=n(_e,2),oe=s(ke);re(()=>{e(U),Tt(()=>{})});var Ce=s(oe);Ce.value=Ce.__value="all";var Ee=n(Ce);Ee.value=Ee.__value="draft";var Me=n(Ee);Me.value=Me.__value="open";var Pe=n(Me);Pe.value=Pe.__value="closed";var Ue=n(Pe);Ue.value=Ue.__value="finished",r(oe),r(ke);var gt=n(ke,2);r(He),r(ye);var Ie=n(ye,2);{var xt=t=>{var o=Yt(),w=s(o),m=s(w),d=s(m);r(m);var c=n(m,2),b=s(c);{var x=M=>{var S=Wt(),W=se(S),ze=n(W,2);l("click",W,lt),l("click",ze,dt),h(M,S)};k(b,M=>{e(pe)&&M(x)})}var z=n(b,2);{var $=M=>{var S=Xt();l("click",S,ct),h(M,S)};k(z,M=>{e(me)&&M($)})}var F=n(z,2);r(c),r(w),r(o),re(()=>P(d,`${e(a),v(()=>e(a).size)??""} contest${e(a),v(()=>e(a).size!==1?"s":"")??""} selected`)),l("click",F,()=>{e(a).clear(),u(a,e(a))}),h(t,o)};k(Ie,t=>{e(Le)&&t(xt)})}var Re=n(Ie,2),yt=s(Re);{var _t=t=>{var o=Ge(),w=se(o);{var m=c=>{var b=er(),x=n(s(b),2);{var z=$=>{var F=Zt();l("click",F,()=>ue("/admin/contests/new")),h($,F)};k(x,$=>{e(ve)&&$(z)})}r(b),h(c,b)},d=c=>{var b=nr(),x=se(b),z=s(x),$=s(z),F=s($),M=s(F),S=s(M);je(S),r(M),Je(5),r(F),r($);var W=n($);Ht(W,5,()=>e(_),Ut,(X,i)=>{var R=or(),D=s(R),j=s(D);je(j),r(D);var V=n(D),Y=s(V),L=s(Y),ie=s(L,!0);r(L);var B=n(L,2),$e=s(B);r(B);var O=n(B,2),Se=s(O);r(O),r(Y),r(V);var N=n(V),Ae=s(N,!0);r(N);var q=n(N),Z=s(q),Q=n(Z),ne=s(Q);r(Q),r(q);var ee=n(q),Fe=s(ee),kt=s(Fe,!0);r(Fe),r(ee);var Ve=n(ee),Oe=s(Ve),Ne=s(Oe);{var Ct=A=>{var T=sr(),le=se(T),de=n(le,2);{var Pt=G=>{var te=tr();l("click",te,()=>ot(e(i).id)),h(G,te)},zt=G=>{var te=Ge(),St=se(te);{var At=De=>{var qe=rr();l("click",qe,()=>it(e(i).id)),h(De,qe)};k(St,De=>{e(i),v(()=>e(i).status==="published")&&De(At)},!0)}h(G,te)};k(de,G=>{e(i),v(()=>e(i).status==="draft")?G(Pt):G(zt,!1)})}var $t=n(de,2);l("click",le,()=>ue(`/admin/contests/${e(i).id}`)),l("click",$t,()=>ut(e(i))),h(A,T)};k(Ne,A=>{e(pe)&&A(Ct)})}var Et=n(Ne,2);{var Mt=A=>{var T=ar();l("click",T,()=>nt(e(i).id)),h(A,T)};k(Et,A=>{e(me)&&A(Mt)})}r(Oe),r(Ve),r(R),re((A,T,le,de)=>{Ke(j,A),P(ie,(e(i),v(()=>e(i).title))),P($e,`Match: ${e(i),v(()=>e(i).matchId)??""}`),P(Se,`Entry: ${T??""}`),P(Ae,le),P(Z,`${e(i),v(()=>e(i).currentEntries)??""} / ${e(i),v(()=>e(i).maxEntries)??""} `),Vt(ne,`width: ${e(i),v(()=>e(i).currentEntries/e(i).maxEntries*100)??""}%`),Ot(Fe,1,`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${de??""}`),P(kt,(e(i),v(()=>e(i).status)))},[()=>(e(a),e(i),v(()=>e(a).has(e(i).id))),()=>(e(i),v(()=>Te(e(i).entryFee))),()=>(e(i),v(()=>Te(e(i).prizePool))),()=>(e(i),v(()=>pt(e(i).status)))]),l("change",j,()=>st(e(i).id)),h(X,R)}),r(W),r(z),r(x);var ze=n(x,2);{var wt=X=>{var i=ir(),R=s(i),D=s(R),j=s(D),V=n(j,2);r(D);var Y=n(D,2),L=s(Y),ie=s(L),B=n(s(ie)),$e=s(B,!0);r(B);var O=n(B,2),Se=s(O,!0);r(O);var N=n(O,2),Ae=s(N,!0);r(N),Je(),r(ie),r(L);var q=n(L,2),Z=s(q),Q=s(Z),ne=n(Q,2);r(Z),r(q),r(Y),r(R),r(i),re(ee=>{j.disabled=e(C)===1,V.disabled=e(C)===e(ae),P($e,(e(C)-1)*be+1),P(Se,ee),P(Ae,e(I)),Q.disabled=e(C)===1,ne.disabled=e(C)===e(ae)},[()=>(e(C),e(I),v(()=>Math.min(e(C)*be,e(I))))]),l("click",j,()=>{ce(C,-1),E()}),l("click",V,()=>{ce(C),E()}),l("click",Q,()=>{ce(C,-1),E()}),l("click",ne,()=>{ce(C),E()}),h(X,i)};k(ze,X=>{e(ae)>1&&X(wt)})}re(()=>Ke(S,(e(a),e(_),v(()=>e(a).size===e(_).length&&e(_).length>0)))),l("change",S,at),h(c,b)};k(w,c=>{e(_),v(()=>e(_).length===0)?c(m):c(d,!1)},!0)}h(t,o)};k(yt,t=>{t(_t,!1)})}r(Re),r(ge),It(we,()=>e(K),t=>u(K,t)),l("input",we,mt),Rt(oe,()=>e(U),t=>u(U,t)),l("change",oe,ht),l("click",gt,vt),h(We,ge),Lt(),Ze()}export{kr as component};
